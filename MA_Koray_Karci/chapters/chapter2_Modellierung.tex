\chapter{Modellierung}\label{ch:ch2}
In diesem Kapitel wird ein für die Simulation verwendetes detailliertes Modell des Antriebsstrangs hergeleitet. Hierfür wird ein vorhandenes, starres Modell um Elastizitäten der Seitenwellen ergänzt. Außerdem wird die Reibung an den Schaltelementen mit einem dynamischen Reibmodell modelliert.


\section{Modellierung des Antriebsstrangs}
Zur Modellierung des Antriebsstrangs wird die Getriebedynamik mittels der Newton-Euler Gleichungen berechnet. Dazu wird zu Beginn kurz auf die Herleitung dieser Gleichungen eingegangen \cite{Schiehlen.2017}. Danach werden die Zwangsbedingungen im Getriebe anhand des schematischen Getriebeaufbaus hergeleitet und somit die Getriebedynamik berechnet. Des Weiteren wird der Abtriebsstrang um die Elastizitäten der Seitenwellen ergänzt. Durch die zusätzliche Berücksichtigung der zustandsabhängigen Widerstandsmomente am Rad ergibt sich somit ein schwingfähiges nichtlineares System. 

\subsection{Beschreibung des allgemeinen Newton-Euler-Formalismus}
Die Position und Orientierung von jedem Körper $i$ eines holonomen Mehrkörpersystems mit $p$ Körpern und $f$ Freiheitsgraden (FHG), kann in Abhängigkeit der verallgemeinerten Koordinaten $\pmb{y}\in \mathbb{R}^f$ angegeben werden mit
\begin{align}
\pmb{r}_i &= \pmb{r}_i(\pmb{y},t),\quad i = 1(1)p\\
\pmb{s}_i &= \pmb{s}_i(\pmb{y},t).
\end{align}
Durch die zeitliche Ableitung dieser Gleichungen ergeben sich die translatorischen und rotatorischen Geschwindigkeiten
\begin{align}\label{vi}
\pmb{v}_i &=  \dot{\pmb{r}}_i = \frac{\partial\pmb{r}_i}{\partial\pmb{y}}\cdot \dot{\pmb{y}} + \frac{\partial\pmb{r}_i}{\partial\pmb{t}} = \pmb{J}_{Ti}(\pmb{y},t)\cdot \dot{\pmb{y}} + \overline{\pmb{v}}_i(\pmb{y},t)\\\label{omegai}
\pmb{\omega}_i &=  \dot{\pmb{s}}_i = \frac{\partial\pmb{s}_i}{\partial\pmb{y}}\cdot \dot{\pmb{y}} + \frac{\partial\pmb{s}_i}{\partial\pmb{t}} = \pmb{J}_{Ri}(\pmb{y},t)\cdot \dot{\pmb{y}} + \overline{\pmb{\omega}}_i(\pmb{y},t)
\end{align}
mit den Jacobi-Matrizen der Translation $\pmb{J}_{Ti}$ und der Rotation $\pmb{J}_{Ri}$. Die lokalen Geschwindigkeitsvektoren $\overline{\pmb{v}}_i(\pmb{y},t)$ und $\overline{\pmb{\omega}}_i(\pmb{y},t)$ treten nur bei Systemen mit rheonomen Bindungen auf \cite[S.46]{Schiehlen.2017}. Nach erneuter zeitlicher Ableitung ergeben sich die Beschleunigungen zu
\begin{align}
\pmb{a}_i = \dot{\pmb{v}}_i &= \pmb{J}_{Ti} \cdot \ddot{\pmb{y}} + \dot{\pmb{J}}_{Ti} \cdot \dot{\pmb{y}} + \dot{\overline{\pmb{v}}}_i = \pmb{J}_{Ti}(\pmb{y},t) \cdot \ddot{\pmb{y}} + \overline{\pmb{a}}_i(\pmb{y},\dot{\pmb{y}},t)\\
\pmb{\alpha}_i = \dot{\pmb{\omega}}_i &= \pmb{J}_{Ri} \cdot \ddot{\pmb{y}} + \dot{\pmb{J}}_{Ri} \cdot \dot{\pmb{y}} + \dot{\overline{\pmb{\omega}}}_i = \pmb{J}_{Ri}(\pmb{y},t) \cdot \ddot{\pmb{y}} + \overline{\pmb{\alpha}}_i(\pmb{y},\dot{\pmb{y}},t)\label{alphai}
\end{align}
mit den lokalen Beschleunigungsvektoren $\overline{\pmb{a}}_i$ und $ \overline{\pmb{\alpha}}_i$. 
Des Weiteren lassen sich für die Dynamik eines Systems virtuelle Bewegungen definieren. Diese sind willkürliche, infinitesimale Bewegungen des Systems, welche mit den skleronomen und den rheonomen Bindungen verträglich sind. Für virtuelle Bewegungen an holonomen Bindungen gilt
\begin{align}
\delta \pmb{r} &= \pmb{0},\label{VB0}\\
\delta t &= 0.
\end{align} 
Damit lassen sich die virtuellen Bewegungen der einzelnen Körper $i$ definieren zu
\begin{align}\label{VBr}
\delta \pmb{r}_i = \frac{\partial\pmb{r}_i}{\partial\pmb{y}}\cdot \delta\pmb{y} &= \pmb{J}_{Ti}(\pmb{y},t)\cdot\delta\pmb{y}\\
\delta \pmb{s}_i = \frac{\partial\pmb{s}_i}{\partial\pmb{y}}\cdot \delta\pmb{y} &= \pmb{J}_{Ri}(\pmb{y},t)\cdot\delta\pmb{y}.\label{VBs}
\end{align}
Die Kinetik eines Körpers $i$ wird durch die Newtonschen- und Eulerschen-Gleichungen beschrieben. 
Die Newtonschen-Gleichungen eines Körpers $i$ lassen sich angeben als
\begin{equation}\label{NewtonGl}
m_i \pmb{a}_i(t) = \pmb{f}_i(t)
\end{equation}
wobei $m_i$ die Masse des Körpers angibt und $\pmb{f}_i(t)$ die Summe der angreifenden Kräfte. Diese lassen sich wiederum einteilen in eingeprägte Kräfte $\pmb{f}^e$ und Reaktionskräfte $\pmb{f}^r$.
Die Eulerschen Gleichungen lauten
\begin{equation}\label{EulerGl}
\pmb{I}_i(t)\cdot\pmb{\alpha}_i(t) + \tilde{\pmb{\omega}}_i(t)\cdot \pmb{I}_i(t)\pmb{\omega}_i(t)= \pmb{l}_i(t)
\end{equation}
mit dem Trägheitstensor $\pmb{I}_i(t)$ und den äußeren Momenten $\pmb{l}_i(t)$ bezogen auf den Massenmittelpunkt des Körpers $i$ im Inertialsystem und dem schiefsymmetrische 3x3-Tensor $\tilde{\pmb{\omega}}_i(t)$. Die äußeren Momenten $\pmb{l}_i(t)$ lassen sich äquivalent zum translatorischen Fall wieder in eingeprägte Momente $\pmb{l}^e$ und Reaktionsmomente $\pmb{l}^r$ aufteilen. Der schiefsymmetrische 3x3-Tensor ist für ein beliebigen Vektor 
\begin{equation}
\pmb{v} = [v_1 \quad v_2 \quad v_3]^T
\end{equation}
definiert als
\begin{equation}
\tilde{\pmb{v}} = \begin{bmatrix} 0 & -v_3 & v_2 \\ v_3 & 0 & -v_1 \\ -v_2 & v_1 & 0 \end{bmatrix}.
\end{equation}
Darüber hinaus kann mit den virtuellen Bewegungen aus (\ref{VBr}) und (\ref{VBs}) die virtuelle Arbeit $\delta \pmb{W}$ definiert werden. Da es, wie in (\ref{VB0}) definiert, in Richtung der Bindungen keine virtuellen Bewegungen geben kann, ergibt sich für die virtuelle Arbeit der Reaktionskräfte zu
\begin{equation}\label{VA}
\delta\pmb{W}^r = \sum_{i=1}^p(\pmb{f}_i^r\cdot \delta \pmb{r}_i + \pmb{l}^r_i\cdot\delta\pmb{s}_i)=0.
\end{equation}
Mit den Gleichungen \eqref{NewtonGl}, \eqref{EulerGl} und der beschriebenen Aufteilung der äußeren Kräfte in eingeprägte Kräfte und Reaktionskräfte, folgt aus \eqref{VA} das d’Alembertsche Prinzip für Mehrkörpersysteme
\begin{equation}\label{VA}
\sum_{i=1}^p\left[ (m_i\pmb{a}_i-\pmb{f}_i^e)\cdot \delta \pmb{r}_i + (\pmb{I_i}\cdot \pmb{\alpha}_i + \tilde{\pmb{\omega}}\cdot\pmb{I}_i\cdot\pmb{\omega}_i-\pmb{l}^e_i)\cdot\delta\pmb{s}_i\right] =0.
\end{equation}
Durch einsetzten der virtuellen Bewegungen (\ref{VBr}) und (\ref{VBs}) ergibt sich daraus
\begin{equation}
\delta\pmb{y}\cdot \sum_{i=1}^p\left[\pmb{J}^T_{Ti}\cdot(m_i\pmb{a}_i-\pmb{f}_i^e)+ \pmb{J}^T_{Ri}\cdot(\pmb{I_i}\cdot \pmb{\alpha}_i + \tilde{\pmb{\omega}}\cdot\pmb{I}_i\cdot\pmb{\omega}_i-\pmb{l}^e_i)\right]=0.
\end{equation}
Das Einarbeiten der kinematischen Gleichungen (\ref{vi}) -- (\ref{alphai}) in ... führt zur Bewegungsgleichung für holonome Mehrkörpersysteme (MKS) 
\begin{align}\label{Bwg_lang}
\begin{split}
\underbrace{\sum_{i=1}^p\left[\pmb{J}_{Ti}^T\cdot m_i \cdot \pmb{J}_{Ti} + \pmb{J}_{Ri}^T\cdot \pmb{I}_i \cdot \pmb{J}_{Ri}\right]}_{\pmb{M}(\pmb{y},t)}\ddot{\pmb{y}}+\underbrace{\sum_{i=1}^p\left[\pmb{J}_{Ti}^T\cdot m_i \cdot \overline{\pmb{a}}_i + \pmb{J}^T_{Ri}\cdot\pmb{I}_i\cdot\overline{\pmb{\alpha}}_i+\pmb{J}^T_{Ri}\cdot\tilde{\pmb{\omega}}_i\cdot\pmb{I}_i\cdot\pmb{\omega_i}\right]}_{\pmb{k}(\pmb{y},\dot{\pmb{y}},t)}=\\ \underbrace{\sum_{i=1}^p\left[\pmb{J}^T_{Ti}\cdot\pmb{f}_i^e + \pmb{J}_{Ri}^T\cdot\pmb{I}_i^e\right]}_{\pmb{q}(\pmb{y},\dot{\pmb{y}},t)}.
\end{split}
\end{align}
Darin lässt sich die erste Summe zur Massenmatrix $\pmb{M}(\pmb{y},t)$, die zweite Summe zum Vektor der verallgemeinerten Zentrifugal-- und Coriloriskräfte $\pmb{k}(\pmb{y},\dot{\pmb{y}},t)$ und die dritte Summe zum Vektor der verallgemeinerten Kräfte $\pmb{q}(\pmb{y},\dot{\pmb{y}},t)$ zusammenfassen, wodurch sich (\ref{Bwg_lang}) schreiben lässt als
\begin{equation}\label{Bwg}
\pmb{M}(\pmb{y},t)\cdot\ddot{\pmb{y}}+\pmb{k}(\pmb{y},\dot{\pmb{y}},t) = \pmb{q}(\pmb{y},\dot{\pmb{y}},t)
\end{equation} 
  
\subsection{Beschreibung des Getriebeaufbaus}
Mit der allgemeinen Bewegungsgleichung für MKS (\ref{Bwg}) kann die Getriebedynamik berechnet werden. Das in dieser Arbeit betrachtete Getriebe besteht im wesentlichen aus vier hintereinander liegenden Planetengetrieben. Der schematische Aufbau eines Umlaufgetriebes ist in Abbildung \ref{fig:gearbox} zu sehen. Dieses besteht aus dem Sonnenrad in der Mitte, den darum gleichmäßig verteilten Planetenrädern, welche auf dem Planetenträger drehbar gelagert sind und dem Hohlrad. Der Zusammenhang der einzelnen Drehzahlen ist gegeben durch die beiden Zwangsbedingungen (ZB) auf Geschwindigkeitsebene
\begin{align}
\mathrm{Sonne - Planeten}:\quad &r_{\mathrm{S},j}\omega_{\mathrm{S},j} - r_{\mathrm{T},j}\omega_{\mathrm{T},j}+ r_{\mathrm{P},j}\omega_{\mathrm{P},j}=0 \\
\mathrm{Planeten - Hohlrad}:\quad &r_{\mathrm{H},j}\omega_{\mathrm{H},j} - r_{\mathrm{T},j}\omega_{\mathrm{T},j}- r_{\mathrm{P},j}\omega_{\mathrm{P},j}=0
\end{align}
mit den Rollradien $r_{S,j}$, $r_{P,j}$, $r_{T,j}$ und $r_{H,j}$ des Sonnenrads, des Planetenrads, des Planententrägers und des Hohlrades im $j$-ten Planetensatz. Entsprechenden gelten die Indizes auch für die Winkelgeschwindigkeiten $\omega_{S,j}$, $\omega_{P,j}$, $\omega_{T,j}$ und $\omega_{H,j}$.
Dabei gilt, dass die Verhältnisse der Rollradien denen der Zähnezahlen einer Zahnradverbindung entsprechen \cite[S. 114f]{Fischer.2016}. Der Rollradius des Planetenträger entspricht somit der Summe der Zähnezahl der Sonne $z_{S,j}$ und des Planeten $z_{P,j}$ und es ergibt sich
\begin{align}\label{ZB_zahnS}
\mathrm{Sonne - Planeten}:\quad &z_{\mathrm{S},j}\omega_{\mathrm{S},j} - (z_{\mathrm{S},j} + z_{\mathrm{P},j})\omega_{\mathrm{T},j}+ z_{\mathrm{P},j}\omega_{\mathrm{P},j}=0 \\ \label{ZB_zahnH}
\mathrm{Planeten - Hohlrad}:\quad &z_{\mathrm{H},j}\omega_{\mathrm{H},j} - (z_{\mathrm{H},j} - z_{\mathrm{P},j})\omega_{\mathrm{T},j}- z_{P,j}\omega_{\mathrm{P},j}=0.
\end{align}
Die Größe  $z_{H,j}$ entspricht der Zähnezahl am Hohlrad im $j$-ten Planetensatz. Die Verschaltung der vier Planetensätze zeigt Abbildung \ref{fig:gearbox}. Aus den acht Wellen ergeben sich entsprechende acht FHG im des MKS. Vier weitere kommen durch die Planten der einzelnen Planetensätze hinzu. Somit hat des freie MKS $f_{\textrm{free}}=12$ FHG. Unter Berücksichtigung der beiden Zwangsbedinungen (\ref{ZB_zahnS}) und (\ref{ZB_zahnH}) ergibt sich somit die Anzahl der FHG des beschränkten MKS zu
\begin{equation}
f=f_{\textrm{free}}-4q = 12-8 = 4
\end{equation}
mit der Anzahl der ZB $q$ in jedem Planetensatz. Weiterhin ergeben sich durch die ZB an den einzelnen Planetensätzen die Zusammenhänge
\begin{subequations}\label{eq:zwangsbedingungen}
	\begin{align} 
\mathrm{Planetensatz\ 1}: \quad z_{\mathrm{S},1} \omega_{1}  &= (z_{\mathrm{S},1} + z_\mathrm{P}) \omega_{8} - z_{\mathrm{P},1} \omega_{9}\\
z_{\mathrm{H},1} \omega_{4}  &= (z_{\mathrm{H},1} - z_\mathrm{P}) \omega_{8} + z_{\mathrm{P},1} \omega_{9} \\
\mathrm{Planetensatz\ 2}: \quad z_{\mathrm{S},2} \omega_{5}  &= (z_{\mathrm{S},2} + z_\mathrm{P}) \omega_{4} - z_{\mathrm{P},2} \omega_{10} \\
z_{\mathrm{H},2} \omega_{3}  &= (z_{\mathrm{H},2} - z_\mathrm{P}) \omega_{4} + z_{\mathrm{P},2} \omega_{10} \\
\mathrm{Planetensatz\ 3}: \quad z_{\mathrm{S},3} \omega_{3}  &= (z_{\mathrm{S},3} + z_\mathrm{P}) \omega_{2} - z_{\mathrm{P},3} \omega_{11} \\
z_{\mathrm{H},3} \omega_{6}  &= (z_{\mathrm{H},3} - z_\mathrm{P}) \omega_{2} + z_{\mathrm{P},3} \omega_{11} \\
\mathrm{Planetensatz\ 4}: \quad z_{\mathrm{S},4} \omega_{3}  &= (z_{\mathrm{S},4} + z_\mathrm{P}) \omega_{1} - z_{\mathrm{P},4} \omega_{12} \\
z_{\mathrm{H},4} \omega_{7}  &= (z_{\mathrm{H},4} - z_\mathrm{P}) \omega_{1} + z_{\mathrm{P},4} \omega_{12}.
	\end{align}
\end{subequations} 
\\
Die Gangschaltung erfolgt im Getriebe über jeweils drei Lamellenkupplungen und Lamellenbremsen. Mit Hilfe der Kupplungen lassen sich die Wellen 1 und 8, 8 und 3 und 2 und 7 verkoppeln. Über die drei Bremsen können die Wellen 8, 5 und 6 gegen das Gehäuse abgestützt werden. Um einen Gang zu schalten müssen drei der Schaltelemente betätigt sein. Dadurch verbleibt nur noch ein FHG der Getriebedynamik und es ergibt sich eine eindeutige Übersetzung zwischen Eingangsdrehzahl $\omega_{1}$ und Ausgangsdrehzahl $\omega_2$. Die sich durch die jeweiligen Schaltungen ergebenden Übersetzungen können Tabelle \ref{tbl:clutches} entnommen werden.
\begin{table}
	\caption{Übersetzung und aktive Schaltelemente je Gang.}
	\label{tbl:clutches}
	\centering
	\begin{tabular}{l*{7}{c}} 
		\toprule
		& & \multicolumn{6}{c}{Schaltelement} \\
		\cmidrule{3-8}
		Gang & Übersetzung & K81 & B05 & B08 & K38 & K27 & B06 \\
		\midrule 
		1. Gang & 5,354 &           & $\bullet$ &           & $\bullet$ &           & $\bullet$ \\
		2. Gang & 3,243 & $\bullet$ &           &           & $\bullet$ &           & $\bullet$ \\
		3. Gang & 2,252 & $\bullet$ & $\bullet$ &           &           &           & $\bullet$ \\
		4. Gang & 1,636 &           & $\bullet$ &           &           & $\bullet$ & $\bullet$ \\
		5. Gang & 1,211 & $\bullet$ & $\bullet$ &           &           & $\bullet$ &           \\
		6. Gang & 1,000 & $\bullet$ &           &           & $\bullet$ & $\bullet$ &           \\
		7. Gang & 0,865 &           & $\bullet$ &           & $\bullet$ & $\bullet$ &           \\
		8. Gang & 0,717 &           &           & $\bullet$ & $\bullet$ & $\bullet$ &           \\
		9. Gang & 0,601 &           & $\bullet$ & $\bullet$ &           & $\bullet$ &           \\
		N       & $-$   &           & $\bullet$ &           &           &           & $\bullet$ \\
		R       & -4,798&           & $\bullet$ & $\bullet$ &           &           & $\bullet$ \\
		\bottomrule 
	\end{tabular} 
\end{table}

\begin{figure}
	\centering    % preferable over \begin{center}...\end{center} as the latter includes space before and after the figure 
	\includegraphics[scale=1]{figures/02_Modellierung/gearbox_schematic_color_with_labels.pdf}
	\caption{Schematischer Aufbau des Getriebes.}
	\label{fig:gearbox} % always use \label AFTER \caption
\end{figure}

\subsection{Anwendung des Newton-Euler-Formalismus}\label{ssec:AnwNE}
Die Wellen und Planeten rotieren alle nur um eine Achse bzw. bewegen sich nur auf einer Kreisbahn. Daher werden die Orientierungen und Ortsvektoren des einzelnen Körper als skalare angegeben. Die Ortsvektoren werden als Zylinderkoordinaten geschrieben. Somit ergibt sich der Vektor der Orientierungen der einzelnen Wellen und der Planeten zu 
\begin{equation}
\pmb{s} = \begin{bmatrix} s_{1}\quad s_{2}\quad \dots \quad s_{12} \end{bmatrix}^T = \begin{bmatrix} \phi_{1}\quad \phi_{2}\quad \dots \quad \phi_{12} \end{bmatrix}^T.
\end{equation} 
Die Ortsvektoren der Wellen 1-8 können aufgrund der nicht vorhanden translatorischen Bewegung gleich Null gesetzt werden. Lediglich die Planeten haben durch die Bewegung auf den Planetenträgern um die Drehachse einen translatorischen Anteil. Die Position der Planeten ergibt sich somit aus den entsprechenden Radien der Planetenträgern $r_{T,j}$ und der Orientierung der Planetenträgern. Damit kann der Orstvektor des Systems geschrieben werden als
\begin{equation}
\pmb{r} = \begin{bmatrix} r_{1}\; r_{2}\; \dots \; r_{12} \end{bmatrix}^T = \begin{bmatrix} 0\; \dots \; 0 \quad r_{T,1}\,\phi_8 \quad r_{T,2}\,\phi_4 \quad r_{T,3}\,\phi_2 \quad r_{T,4}\,\phi_1 \end{bmatrix}^T
\end{equation}
Da das MKS $f=4$ FHG hat lässt sich nach \cite{Schiehlen.2017} dieses durch verallgemeinerte Koordinaten $\pmb{y}\in \mathbb{R}^f$ beschreiben. Dabei liegt es nahe, die zu den am Getriebe gemessenen Winkelgeschwindigkeiten gehörigen Winkel $\phi_{1}$, $\phi_{2}$ und $\phi_{8}$ zu verwenden. Zudem wird $\phi_{3}$ als weiterer FHG gewählt. Dadurch ergibt sich der Vektor der verallgemeinerten Koordinaten zu
\begin{equation}
\pmb{y} = \begin{bmatrix} \phi_{1}\quad \phi_{2}\quad \phi_{3}\quad \phi_{8} \end{bmatrix}^T.
\end{equation}
Die Zusammenhänge in (\ref{eq:zwangsbedingungen}) gelten auch für die zugehörigen Winkel. Damit können $\pmb{s}$ und $\pmb{r}$ in Abhängigkeit der verallgemeinerten Koordinaten angegeben werden. Die Einträge von $\pmb{s}(\pmb{y})$ ergeben sich zu 
\begin{subequations}\label{eq:zwangsbedingungen_aufgelöst}
	\begin{align}
	 	\phi_1 &= \phi_1 \\
	 	\phi_2 &= \phi_2 \\
	 	\phi_3 &= \phi_3 \\ \label{eq:s4}
		\phi_{4} &= -\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}} } \phi_1 +\left(\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}} }+1\right) \phi_8 \\
		\phi_{5} &= \left(-\frac{z_\mathrm{S,1} }{z_\mathrm{H,1} }-\frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{S,2}} \right) \phi_1
			-\frac{z_\mathrm{H,2} }{z_\mathrm{S,2}} \phi_3
			+\left(\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}} }+\frac{z_{\mathrm{H,2}} }{z_{\mathrm{S,2}} }+\frac{z_{\mathrm{H,2}} z_{\mathrm{S,1}}}{z_{\mathrm{H,1}} z_{\mathrm{S,2}}} +1\right) \phi_8 \\
		\phi_{6} &= \left(\frac{z_{\mathrm{S,3}} }{z_{\mathrm{H,3}} }+1\right) \phi_2 - \frac{z_{\mathrm{S,3}} }{z_{\mathrm{H,3}} } \phi_3 \\
		\phi_{7} &= \left(\frac{z_{\mathrm{S,4}} }{z_{\mathrm{H,4}} }+1\right) \phi_1 - \frac{z_{\mathrm{S,4}} }{z_{\mathrm{H,4}} } \phi_3 \\
		\phi_8 &= \phi_8 \\
		\phi_{9} &= -\frac{z_{\mathrm{S,1}} }{z_\mathrm{P,1} } \phi_1 +\left(\frac{z_\mathrm{S,1} }{z_\mathrm{P,1}} +1\right) \phi_8 \\
		\phi_{10} &= \left(\frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{P,2}} + \frac{z_\mathrm{S,1}}{z_\mathrm{H,1}} \right) \omega_1
			+\frac{z_\mathrm{H,2}}{z_\mathrm{P,2}} \phi_3
			+\left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}} -\frac{z_\mathrm{H,2} }{z_\mathrm{P,2} }-\frac{z_\mathrm{H,2}  z_\mathrm{S,1}}{z_\mathrm{H,1}  z_\mathrm{P,2}} + 1\right) \phi_8 \\
		\phi_{11} &= \left( \frac{z_{\mathrm{S,3}}}{z_{\mathrm{P,3}}} + 1 \right) \phi_2 -\frac{z_{\mathrm{S,3}}}{z_{\mathrm{P,3}}} \phi_3 \\
		\phi_{12} &= \left( \frac{z_{\mathrm{S,4}}}{z_{\mathrm{P,4}}} + 1 \right) \phi_1 -\frac{z_{\mathrm{S,4}}}{z_{\mathrm{P,4}}} \phi_3
	\end{align}
\end{subequations}
Die Einträge von $\pmb{r}$ sind bis auf den Zehnten bereits in Abhängigkeit von $\pmb{y}$ angegeben. Der verbleibende Eintrag kann mit (\ref{eq:s4}) wie folgt angegeben werden
\begin{equation}
r_{10}(\pmb{y}) = r_{T,2}\,\phi_4 = r_{T,2}\,\left(-\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}} } \phi_1 +\left(\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}} }+1\right) \phi_8\right).
\end{equation}
Durch die zeitliche Ableitung von $\pmb{r}(\pmb{y})$ und $\pmb{s}(\pmb{y})$ gemäß (\ref{vi}) und \ref{omegai} erhält man die Jacobi-Matrizen der Translation
\begin{equation}
\pmb{J}_\mathrm{T} = \begin{bmatrix}
J_\mathrm{T1} & J_\mathrm{T2} & \cdots & J_\mathrm{T12}
\end{bmatrix}^T
\end{equation}  
und der Rotation 
\begin{equation}
\pmb{J}_\mathrm{R} = \begin{bmatrix}
J_\mathrm{R1} & J_\mathrm{R2} & \cdots & J_\mathrm{R12}
\end{bmatrix}^T,
\end{equation} 
welche die einzelnen Jacobi-Matrizen der Körper enthalten. Die Terme $\overline{\pmb{v}}$ und $\overline{\pmb{\omega}}$ verschwinden, da es sich um skleronome Bindungen handelt und die ZB (\ref{eq:zwangsbedingungen}) nicht explizit zeitabhängig sind. Auch die lokalen Beschleunigungsvektoren $\overline{\pmb{a}}$ und $\overline{\pmb{\omega}}$ verschwinden, da $\pmb{J}_\mathrm{T}$ und $\pmb{J}_\mathrm{R}$ zeitlich konstant sind. In der allgemeinen Bewegungsgleichung für holonome MKS (\ref{Bwg}) verschwinden somit die Zentrifugalkräfte in $\pmb{k}(\pmb{y},\dot{\pmb{y}},t)$. Auch die Corioliskräfte verschwinden, da für alle Körper das Inertialsystem als Referenzsystem verwendet wird. Im Vektor der verallgemeinerten Kräfte $\pmb{q}(\pmb{y},\dot{\pmb{y}},t)$ werden die eingeprägten Kräfte $\pmb{f}^e_i$ vernachlässigt da die translatorischen Bewegungen im Getriebe sehr klein gegenüber der rotatorischen Bewegungen sind. Somit reduziert sich (\ref{Bwg}) auf
\begin{equation}
\pmb{M}(\pmb{y},t)\cdot\ddot{\pmb{y}} = \pmb{q}(\pmb{y},\dot{\pmb{y}},t)
\end{equation}
wobei die Massenmatrix mit $\pmb{J}_\mathrm{T}$ und $\pmb{J}_\mathrm{R}$ jetzt angegeben werden kann als 
  \begin{equation}
\pmb{M}(\pmb{y},t) = \pmb{J}_\mathrm{T}^T\cdot\mathrm{diag}(m_i)\cdot\pmb{J}_\mathrm{T}+\pmb{J}_\mathrm{R}^T\cdot\mathrm{diag}(I_i)\cdot\pmb{J}_\mathrm{R}
\end{equation}
und der Vektor der verallgemeinerten Kräfte als
  \begin{equation}
\pmb{q}(\pmb{y},\dot{\pmb{y}},t) = \pmb{J}_\mathrm{R}^T\cdot\mathrm{\pmb{l}}^e 
\end{equation}
Die eingeprägten Momente sind die von den Schaltelementen aufgebrachten Momente $\mathrm{T}_{\mathrm{B05}}$, $\mathrm{T}_{\mathrm{B06}}$, $\mathrm{T}_{\mathrm{B08}}$, $\mathrm{T}_{\mathrm{K81}}$, $\mathrm{T}_{\mathrm{K38}}$ und $\mathrm{T}_{\mathrm{K27}}$. Des Weitern wirken am Getriebeeingang das Moment $\mathrm{T}_{\mathrm{In}}$ und am Getriebeausgang das Moment $\mathrm{T}_{\mathrm{Out}}$. Damit ergibt sich der Vektor der eingeprägten Momente zu
\begin{equation}\label{eq:le}
\mathrm{\pmb{l}}^e = \begin{bmatrix} \mathrm{T}_{\mathrm{In}}+\mathrm{T}_{\mathrm{K81}} \\ -\mathrm{T}_{\mathrm{K27}}-\mathrm{T}_{\mathrm{Out}} \\ -\mathrm{T}_{\mathrm{K38}} \\ 0 \\ \mathrm{T}_{\mathrm{B05}} \\ \mathrm{T}_{\mathrm{B06}} \\ \mathrm{T}_{\mathrm{K27}} \\ \mathrm{T}_{\mathrm{B08}}+\mathrm{T}_{\mathrm{K38}}-\mathrm{T}_{\mathrm{K81}} \\ 0 \\ 0 \\ 0 \\ 0 \end{bmatrix}.
\end{equation}
Das Eingangsmoment $\mathrm{T}_{\mathrm{In}}$ wird vom Verbrennungsmotor und einem Elektromotor gestellt. Das Ausgangssmoment $\mathrm{T}_{\mathrm{Out}}$ wird an die Kardanwelle übertragen. Andere eingeprägte Momente, wie Schleppmomente oder Reibungen an den Lagern werden vernachlässigt. Mit Hilfe der ersten Summe von (\ref{Bwg_lang}) können die Einträge der 4x4-Massenmatrix $\pmb{M}$ berechnet werden. Diese ergeben sich zu
\begin{align*}
	\pmb{M}_{(1,1)} &=  J_1+J_7\left(\frac{z_\mathrm{S,4}}{z_\mathrm{H,4}}+1\right)^2+J_{12} \left(\frac{z_\mathrm{S,4}}{z_\mathrm{P,4}}+1\right)^2+J_{10} {\left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}} - \sigma_{5}\right)}^2+J_{5} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+\sigma_{4}\right)^2 \\
		&\qquad + m_\mathrm{P,4} {r_\mathrm{T,4}}^2+\frac{J_{4} {z_\mathrm{S,1}}^2}{{z_\mathrm{H,1}}^2}+\frac{J_{9} {z_\mathrm{S,1}}^2}{{z_\mathrm{P,1}}^2}+\frac{m_\mathrm{P,2} {r_\mathrm{T,2}}^2 {z_\mathrm{S,1}}^2}{{z_\mathrm{H,1}}^2}\\
	%
	\pmb{M}_{(1,3)} &= \frac{J_{5} z_\mathrm{H,2} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+\sigma_{4}\right)}{z_\mathrm{S,2}}-\frac{J_{12} z_\mathrm{S,4} \left(\frac{z_\mathrm{S,4}}{z_\mathrm{P,4}}+1\right)}{z_\mathrm{P,4}}-\frac{J_{10} z_\mathrm{H,2} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}} - \sigma_{5}\right)}{z_\mathrm{P,2}}-\frac{J_{7} z_\mathrm{S,4} \left(\frac{z_\mathrm{S,4}}{z_\mathrm{H,4}}+1\right)}{z_\mathrm{H,4}}\\
	%
	\pmb{M}_{(1,4)} &= J_{10} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}-\sigma_{5}\right) \sigma_{3} - J_{5} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+\sigma_{4}\right) \sigma_{2} -\frac{J_{4} z_\mathrm{S,1} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+1\right)}{z_\mathrm{H,1}}\\
		&\qquad-\frac{J_{9} z_\mathrm{S,1} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{P,1}}+1\right)}{z_\mathrm{P,1}}-\frac{m_\mathrm{P,2} {r_\mathrm{T,2}}^2 z_\mathrm{S,1} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+1\right)}{z_\mathrm{H,1}}\\
	%
	\pmb{M}_{(2,2)} &= J_2+J_6 \left(\frac{z_\mathrm{S,3}}{z_\mathrm{H,3}}+1\right)^2+J_{11} \left(\frac{z_\mathrm{S,3}}{z_\mathrm{P,3}}+1\right)^2+m_\mathrm{P,3} {r_\mathrm{T,3}}^2\\
	%
	\pmb{M}_{(2,3)} &= -\frac{J_{6} z_\mathrm{S,3} \left(\frac{z_\mathrm{S,3}}{z_\mathrm{H,3}}+1\right)}{z_\mathrm{H,3}}-\frac{J_{11} z_\mathrm{S,3} \left(\frac{z_\mathrm{S,3}}{z_\mathrm{P,3}}+1\right)}{z_\mathrm{P,3}}\\
	\pmb{M}_{(3,1)} &= \pmb{M}_{(1,3)}\\
	\pmb{M}_{(3,2)} &= \pmb{M}_{(2,3)}\\
	\pmb{M}_{(3,3)} &= J_{3}+\frac{J_{10} {z_\mathrm{H,2}}^2}{{z_\mathrm{P,2}}^2}+\frac{J_{5} {z_\mathrm{H,2}}^2}{{z_\mathrm{S,2}}^2}+\frac{J_{6} {z_\mathrm{S,3}}^2}{{z_\mathrm{H,3}}^2}+\frac{J_{7} {z_\mathrm{S,4}}^2}{{z_\mathrm{H,4}}^2}+\frac{J_{11} {z_\mathrm{S,3}}^2}{{z_\mathrm{P,3}}^2}+\frac{J_{12} {z_\mathrm{S,4}}^2}{{z_\mathrm{P,4}}^2} \\
	%
	\pmb{M}_{(3,4)} &= -\frac{J_{10} z_\mathrm{H,2} \sigma_{3}}{z_\mathrm{P,2}} - \frac{J_{5} z_\mathrm{H,2} \sigma_{2}}{z_\mathrm{S,2}}\\
	\pmb{M}_{(4,1)} &= \pmb{M}_{(1,4)}\\
	\pmb{M}_{(4,3)} &= \pmb{M}_{(3,4)}\\
	%
	\pmb{M}_{(4,4)} &= J_8+J_4 \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+1\right)^2+J_{9} \left(\frac{z_\mathrm{S,1}}{z_\mathrm{P,1}}+1\right)^2+m_\mathrm{P,1} {r_\mathrm{T,1}}^2+J_{10} \sigma_{3}^2+J_5 \sigma_{2}^2 \\
		&\qquad + m_\mathrm{P,2} {r_\mathrm{T,2}}^2 \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+1\right)^2\\
	%
	\sigma_1 &= \left(\frac{z_{\mathrm{S,4}}}{z_{\mathrm{H,4}}}+1\right) \\
	\sigma_{2} &= \left(\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+\frac{z_\mathrm{H,2}}{z_\mathrm{S,2}}+\frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{S,2}}+1\right)\\
	\sigma_{3} &= \left(\frac{z_\mathrm{H,2}}{z_\mathrm{P,2}}-\frac{z_\mathrm{S,1}}{z_\mathrm{H,1}}+\frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{P,2}}-1\right) \\
	\sigma_{5} &= \frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{P,2}} \\
	\sigma_{4} &= \frac{z_\mathrm{H,2} z_\mathrm{S,1}}{z_\mathrm{H,1} z_\mathrm{S,2}}
\end{align*}
wobei $J_{1-12}$ die Massenträgheitsmomente der entsprechenden Wellen sind und $m_{\mathrm{P},1-4}$ die Gesamtasse der Planeten eines Planetensatzes. Durch einsetzten von $\pmb{M}$ und \eqref{eq:le} in \eqref{Bwg_lang} ergeben sich die vier Gleichungen der Getriebedynamik
\begin{subequations} \label{eq:bewegungs_gleichungen}
	\begin{align}
		\pmb{M}_{(1,1)} \dot{\omega}_1 + \pmb{M}_{(1,3)} \dot{\omega}_3 +\pmb{M}_{(1,4)} \dot{\omega}_8
		&= T_{\mathrm{K81}} +T_{\mathrm{in}} + \sigma_1 T_{\mathrm{K27}}-T_{\mathrm{B05}} {\left(\frac{z_{\mathrm{S,1}} }{z_{\mathrm{H,1}}}+\sigma_{4} \right)}\\
		%
		\pmb{M}_{(2,2)} \dot{\omega}_2 + \pmb{M}_{(2,3)} \dot{\omega}_3
		&= T_{\mathrm{B06}} {\left(\frac{z_{\mathrm{S,3}} }{z_{\mathrm{H,3}} }+1\right)}-T_{\mathrm{out}} -T_{\mathrm{K27}} \\
		%
		\pmb{M}_{(3,1)} \dot{\omega}_1 + \pmb{M}_{(3,2)} \dot{\omega}_2 + \pmb{M}_{(3,3)} \dot{\omega}_3 + \pmb{M}_{(3,4)} \dot{\omega}_8
		&= -T_{\mathrm{K38}} -\frac{ z_{\mathrm{H,2}} }{z_{\mathrm{S,2}} }T_{\mathrm{B05}}-\frac{z_{\mathrm{S,3}}}{z_{\mathrm{H,3}}}T_{\mathrm{B06}}-\frac{z_{\mathrm{S,4}} }{z_{\mathrm{H,4}}}T_{\mathrm{K27}}\\
		%
		\pmb{M}_{(4,1)} \dot{\omega}_1 + \pmb{M}_{(4,3)} \dot{\omega}_3 + \pmb{M}_{(4,4)} \dot{\omega}_8
		&= T_{\mathrm{B08}} +T_{\mathrm{K38}} -T_{\mathrm{K81}} +\sigma_{2} T_{\mathrm{B05}}.
	\end{align}
\end{subequations}
Mit Hilfe der Definition des Eingangsvektors
\begin{equation}\label{eq:u}
\pmb{u} = \begin{bmatrix} \mathrm{T}_{\mathrm{In}} \quad \mathrm{T}_{\mathrm{Out}} \quad \mathrm{T}_{\mathrm{K81}} \quad \mathrm{T}_{\mathrm{K38}} \quad \mathrm{T}_{\mathrm{B08}} \quad \mathrm{T}_{\mathrm{B05}} \quad \mathrm{T}_{\mathrm{B06}} \quad \mathrm{T}_{\mathrm{K27}} \end{bmatrix}^T
\end{equation}
lassen sich die Gleichungen \eqref{eq:bewegungs_gleichungen} zusammenfassen zu
\begin{equation}
\pmb{M}\,\ddot{\pmb{y}} = \tilde{\pmb{B}}\,\pmb{u}.
\end{equation}
Dieses Differentialgleichungssystem kann mit der Definition des Zustands
\begin{equation}
\pmb{x} = \dot{\pmb{y}} = \begin{bmatrix} \omega_1 \\ \omega_2 \\ \omega_3 \\ \omega_8\end{bmatrix}
\end{equation}
und der Invertierung von $\pmb{M}$ in die Zustandsraumdarstellung 
\begin{equation}
\dot{\pmb{x}} = \pmb{M}^{-1}\tilde{\pmb{B}}\,\pmb{u} = \pmb{B}\,\pmb{u}
\end{equation}
transformiert werden. In dieser Darstellung ist leicht ersichtlich, dass das System aufgrund der fehlenden Systemmatrix nicht zustandsabhängig ist.

\subsection{Erweiterung um elastische Seitenwellen}
Aufgrund der relativ elastischen Seitenwellen kann es im Antriebsstrang zu erheblichen Schwingungen kommen. Um diese bei der Simulation eines Schaltvorgang mit berücksichtigen zu können, soll das in \ref{ssec:AnwNE} hergeleitete Zustandsraummodell um die Elastizitäten erweitert werden. Die Seitenwellen werden dabei als Feder-Dämpfer-Systeme modelliert. Die Kardanwelle wird hingegen als starrer Körper betrachtet. Ein schematischen Aufbau des Antriebsstrangs zeigt Abbildung ???. Zunächst wird der Zustandsvektor um die Verdrehung der Seitenwellen~$\psi$ und die Raddrehzahl~$\omega_\mathrm{C}$ ergänzt, sodass sich der erweiterte Zustandsvektor
\begin{equation}
\pmb{x}_\mathrm{ex} = \begin{bmatrix} \omega_1 \\ \omega_2 \\ \omega_3 \\ \omega_8 \\ \phi \\ \omega_\mathrm{C} \end{bmatrix}
\end{equation}
ergibt. Wie in Abbildung \ref{fig:final_drive} veranschaulicht, ergibt sich die Verdrehung $\phi$ aus der Differenz der Verdrehung am linken Schnittufer der Seitenwellen $\phi_\mathrm{ss,p}$ und der des Rades $\phi_\mathrm{C}$, am rechten Schnittufer. Unter Berücksichtigung der starren Kardanwelle berechnet sich somit für die Verdrehung der Seitenwellen zu
\begin{equation}
\phi = \frac{\phi_2}{i_{\mathrm{D}}} - \phi_\mathrm{C},
\end{equation}  
wobei $i_{\mathrm{D}}$ die Übersetzungen des Differentials angibt. Entsprechend gilt der Zusammenhang auch für die Winkelgeschwindigkeiten
\begin{equation}\label{eq:dynphi}
\dot{\phi} = \frac{\omega_2}{i_{\mathrm{D}}} - \omega_\mathrm{C}.
\end{equation}
Des Weiteren kann am Rad das Momentengleichgewicht
\begin{equation}\label{eq:MggRad}
I^\mathrm{eff}_\mathrm{C}\,\dot{\omega}_\mathrm{C} = 2\,T_\mathrm{ss} - T_\mathrm{res},
\end{equation}
aufgestellt werden. Das effektive Massenträgheitsmomentes des Rads $I^\mathrm{eff}_\mathrm{C}$ setzt sich wie folgt zusammen
\begin{equation}
I^\mathrm{eff}_\mathrm{C} = I_\mathrm{ss} + m_\mathrm{C}\,r_\mathrm{dyn}.
\end{equation}
Dabei ist $I_\mathrm{ss}$ das Massenträgheitsmoment einer Seitenwelle, $m_\mathrm{C}$ die Masse des Rads und $r_\mathrm{dyn}$ der dynamische Radradius. Das Moment $T_\mathrm{ss}$ ist das von den Seitenwellen übertragene Moment und kann mit dem Steifigkeitskoeffizient $k_\mathrm{ss}$ und dem Dämpfungskoeffizient $d_\mathrm{ss}$ berechnet werden zu
\begin{equation}\label{eq:Tss}
T_\mathrm{ss} = k_\mathrm{ss}\left(\frac{\phi_2}{i_{\mathrm{D}}} - \phi_\mathrm{C}\right) + d_\mathrm{ss}\left(\frac{\omega_2}{i_{\mathrm{D}}} - \omega_\mathrm{C}\right) = k_\mathrm{ss} \phi + d_\mathrm{ss} \dot{\phi}.
\end{equation}
Das Fahrwiderstandsmoment $T_\mathrm{res}$ berechnet sich als Summe der berücksichtigten äußeren Fahrwiderstände zu
\begin{equation}\label{eq:Tres}
T_\mathrm{res} = r_\mathrm{dyn}\left(F_\mathrm{r}(v) + F_\mathrm{ad}(v) + F_\mathrm{g}\right). 
\end{equation}
Die berücksichtigten Widerstände sind der Rollwiderstand $F_\mathrm{r}(v)$, der Luftwiderstand $F_\mathrm{ad}(v)$ und die Hangabtriebskraft $F_\mathrm{g}$ und werden wie folgt berechnet
\begin{subequations}\label{eq:Fr_Fas_Fg}
\begin{align}
F_\mathrm{r}(v) &= v \cdot f_\mathrm{Roll}(v)\cdot \cos\left(\zeta\right)\cdot m_\mathrm{veh}\cdot g, \\
F_\mathrm{ad}(v) &= \frac{1}{2}\cdot v^2\cdot\rho_\mathrm{Air}\cdot c_\mathrm{W}\cdot A_\mathrm{front},\\
F_\mathrm{g} &= \sin\left(\zeta \right)\cdot m_\mathrm{veh}\cdot g.
\end{align}
\end{subequations}
Dabei ist $v = \omega_\mathrm{C}\,r_\mathrm{dyn}$ die Fahrzeuggeschwindigkeit, $f_\mathrm{Roll}(v)$ der von der Geschwindigkeit abhängige Faktor
des Rollwiderstands, $\zeta$ die Steigung der Straße in rad, $g$ die Erdbeschleunigung, $\rho_\mathrm{Air}$ die Luftdichte, $c_\mathrm{W}$ der Widerstandsbeiwert des Fahrzeugs, $A_\mathrm{front}$ die Frontfläche des
Fahrzeugs und $m_\mathrm{veh}$ die Gesamtmasse des Fahrzeugs \cite[S.~3ff]{Naunheimer.2007}.
Das Einsetzten von \eqref{eq:Tss} und \eqref{eq:Tres} in \eqref{eq:MggRad} und anschließender Auflösung nach $\dot{\omega}_\mathrm{C}$ führt auf die Dynamik des Rades
\begin{equation}\label{eq:dynwc}
\dot{\omega}_\mathrm{C} = \left[ 2\,\left(k_\mathrm{ss}\left(\frac{\phi_2}{i_{\mathrm{D}}} - \phi_\mathrm{C}\right) + d_\mathrm{ss}\left(\frac{\omega_2}{i_{\mathrm{D}}} - \omega_\mathrm{C}\right)\right) - r_\mathrm{dyn}\left(F_\mathrm{r}(v) + F_\mathrm{ad}(v) + F_\mathrm{g}\right)\right]/I^\mathrm{eff}_\mathrm{C}.
\end{equation}
Aufgrund der angenommenen starren Verbindung von Welle 2, der Kardanwelle und des Differentials, werden die Massenträgheitsmomente dieser Bauteile zusammengefasst zu
\begin{equation}
J^\mathrm{eff}_2 = J_2 + J^\mathrm{eff}_\mathrm{cs} + \frac{J^\mathrm{eff}_\mathrm{ss}}{i_\mathrm{D}^2},
\end{equation}
wobei in das effektive Massenträgheitsmoment der Kardanwelle $J^\mathrm{eff}_\mathrm{cs} = J_\mathrm{cs} + 0,5\,J_\mathrm{D}$ die eine Hälfte des Massenträgheitsmoments des Differentials miteinbezogen wird. Die andere Hälfte wird aufgrund der Drehzahldifferenz nach dem Differential mit dem Massenträgheitsmoment der zweiten Seitenwelle $J^\mathrm{eff}_\mathrm{ss} =  0,5\,J_\mathrm{D} + J_\mathrm{ss}$ zusammen gefasst. Für das erweiterte System wird $J_2$ in $\pmb{M}(2,2)$ dann durch $J^\mathrm{eff}_2$ ersetzt. Des Weiteren wird in Abbildung \ref{fig:final_drive} ersichtlich, dass für das Ausgangsmoment 
\begin{equation}\label{eq:Tout}
T_\mathrm{out} = \frac{2\,T_\mathrm{ss}}{i_\mathrm{D}} = \frac{2}{i_\mathrm{D}}\,\left[ k_\mathrm{ss}\left(\frac{\phi_2}{i_{\mathrm{D}}} - \phi_\mathrm{C}\right) + d_\mathrm{ss}\left(\frac{\omega_2}{i_{\mathrm{D}}} - \omega_\mathrm{C}\right)\right]
\end{equation}
gilt und dieses in \eqref{eq:le} dementsprechend ersetzt werden kann.

Zu beachten ist hier, dass $v(\omega_\mathrm{C})$ zustandsabhängig ist und sowohl in $F_\mathrm{r}(v)$ als auch in $F_\mathrm{ad}(v)$ nichtlinear eingeht, wodurch das Gesamtsystem nichtlinear wird. Auch die Störgröße $\zeta(t)$ geht nichtlinear in die Widerstände ein. Damit lässt sich das erweiterte Modell mit 
den Gleichungen \eqref{eq:dynphi} und \eqref{eq:dynwc} in der Form 
\begin{equation}\label{eq:sys_nl}
\dot{\pmb{x}}_\mathrm{ex} = \pmb{f}(\pmb{x}_\mathrm{ex}) + \pmb{B}_\mathrm{ex,nl}\,\pmb{u}_\mathrm{ex,nl}
\end{equation}
schreiben.


Da in den weiteren Betrachtungen die Dynamik des Getriebes während eines Gangwechsels analysiert wird, kann das Modell auf zwei Gänge reduziert werden. In dieser Arbeit sind dies die Gänge Zwei und Drei. Wie Tabelle \ref{tbl:clutches} entnommen werden kann, sind die Schaltelemete B08 und K27 während beiden Gängen geöffnet daher gilt  
\begin{subequations}
\begin{align*}
T_\mathrm{K27} &= 0 \\
T_\mathrm{B08} &= 0.
\end{align*}
\end{subequations}
Des Weiteren sind in beiden Gängen die Schaltelemente K81 und B06 geschlossen. Daher gelten für beide Gänge die zusätzlichen Zwangsbedingungen
\begin{subequations}
\begin{align}
\omega_6 &= 0\\
\omega_1 &= \omega_8.
\end{align}
\end{subequations}
Damit ergeben sich der reduzierte Zustand und der reduzierte Eingang zu
\begin{equation}
\pmb{x}_\mathrm{ex,nl,23} = \begin{bmatrix} \omega_1 & \omega_2 & \phi & \omega_\mathrm{C}\end{bmatrix}^T
\end{equation}
und
\begin{equation}\label{eq:u_exnl23}
\pmb{u}_\mathrm{ex,nl,23} = \begin{bmatrix} \mathrm{T}_{\mathrm{In}} & \mathrm{T}_{\mathrm{K38}} & \mathrm{T}_{\mathrm{B05}} \end{bmatrix}^T.
\end{equation}
Durch Einsetzten der Zwangsbedingungen in \eqref{eq:zwangsbedingungen_aufgelöst} und der Berücksichtigung des reduzierten Zustands- und  Eingangsvektors ist das nichtlineare reduzierte System
\begin{equation}\label{eq:sys_nl23}
\dot{\pmb{x}}_\mathrm{ex,23} = \pmb{f}_{23}(\pmb{x}_\mathrm{ex,23}) + \pmb{B}_\mathrm{ex,nl23}\,\pmb{u}_\mathrm{ex,nl23}.
\end{equation}

\begin{figure}
   \centering
   \def\svgwidth{\columnwidth}
   \import{figures/02_Modellierung/}{final_drive_with_forces.pdf_tex}
   \caption{Schematische Darstellung des Abtriebsstrangs}
   \label{fig:final_drive}
\end{figure}


\section{Modellierung der Reibung an Kupplungen und Bremsen} \label{sec:mod_reib}
Die im Abschnitt \ref{ssec:AnwNE} eingeführten Momente der Schaltelemente werden über Lamellenkupplungen beziehungsweise -bremsen an den Wellen angebracht. Dabei werden die Lamellenpakete über einen hydraulischen Druck zusammengepresst, sodass zwischen den Flächen Reibkräfte wirken. Solang die aus dem Druck resultierende Normalkraft an Lamellenpaketen nicht ausreicht um die Scheiben gegeneinander abzustützen, wirkt die Reibkraft entgegen der Differnzdrehzahl $\Delta \omega$ der drehenden Scheiben. Ist die Normalkraft groß genug entsteht eine kraftschlüssige Verbindung zwischen Innen- und Außenlamellen. In diesem Fall ist $\Delta \omega = 0$ und der Betrag der Reibkraft entspricht dem der Reaktionskraft und wirkt dieser entgegen.   

Zur Ermittlung der auf die Wellen wirkenden Reaktionsmomente bedarf es eines Reibmodells. Im Wesentlichen können diese in statische und dynamische Reibmodelle eingeteilt werden. Dynamische Reibmodelle unterscheiden sich dadurch, dass sie über mindestens einen weiteren Zustand verfügen. Dies ermöglicht die Simulation von weiteren Reibeffekten wie Hysteresen, variierende Losbrechkräfte oder nicht-gleitende Auslenkungen \cite{Schroeder.2015}. Im folgenden werden statische und dynamische Reibmodelle erläutert.

\subsection{Statische Reibmodelle}
Die einfachste Art der Reibungsmodellierung ist die Coulombsche Reibung. Dabei ist die Reibkraft proportional zur Normalkraft $F_\mathrm{N}$ und einem konstanten Reibungskoeffizienten $\mu_\mathrm{C}$. Nach \cite{Schroeder.2015} ist diese definiert als
\begin{equation}
F_\mathrm{C} = F_\mathrm{N}\,\mu_\mathrm{C}\;\mathrm{sign}(\Delta \omega)=F_\mathrm{N}\,\mu_\mathrm{C}\begin{cases}1&\quad,\Delta \omega>0\\0&\quad,\Delta \omega=0\\-1&\quad,\Delta \omega<0 \end{cases}
\end{equation}
Durch die Erweiterung um einen Haftreibungsbeiwert $\mu_\mathrm{S}$, wird eine benötigte Losbrechkraft mit berücksichtigt. Der Haftreibungsbeiwert $\mu_\mathrm{S}$ ist im Normalfall größer als $\mu_\mathrm{C}$, sodass eine größere Kraft notwendig ist um einen reibungsbehafteten Körper aus der ruhe zu bringen. Für die Haftreibung gilt
\begin{equation}
F_\mathrm{S} = \begin{cases}F_\mathrm{A}&,\vert F_\mathrm{A}\vert < F_\mathrm{N}\,\mu_\mathrm{S} (\wedge\Delta \omega = 0)
\\ F_\mathrm{N}\,\mu_\mathrm{S}\,\mathrm{sign}(F_\mathrm{A})&,\vert F_\mathrm{A}\vert \geq F_\mathrm{N}\,\mu_\mathrm{S} (\wedge\Delta \omega = 0) \end{cases}
\end{equation}
wobei $F_\mathrm{A}$ die Summe der äußeren Kräfte ist. Sind die Reibflächen geschmiert, ist eine Änderung der Reibkennlinie über  die $\Delta \omega$ zu beobachten. Dieses Phänomen berücksichtigt die viskose Reibung. Diese ist definiert als
\begin{equation}
F_\mathrm{V}=\nu\vert\Delta\omega\vert^{\delta_\mathrm{V}}\mathrm{sign}(\Delta\omega)
\end{equation}
mit dem viskosen Reibungsexponenten $\delta_\mathrm{V}$ und dem Reibkoeffizienten $\nu$. Des weiteren lässt sich $F_\mathrm{C}$ durch die Stribeck-Funktion erweitern. Damit wird das rapide Abfallen der Reibkraft bei kleinen Geschwindigkeiten berücksichtigt. Dieser Effekt entsteht durch das Aufbrechen von Kontaktstellen und der anschließenden Bildung eines Schmierfilms \cite{Stribeck.1903}. Eine übliche Modellierung der Stribeck-Funktion ist
\begin{equation}
F_\mathrm{Stribeck} = F_\mathrm{C} + F_\mathrm{N}(\mu_\mathrm{S}-\mu_\mathrm{C})\mathrm{exp}\left[-\left(\frac{\vert\Delta \omega \vert}{\omega_\mathrm{S}}\right)^{\delta_\mathrm{S}}\right]
\end{equation} 
mit der Stribeck-Geschwindigkeit $\omega_\mathrm{S}$ und dem Stribeck-Exponent $\delta_\mathrm{S}$. Die verschiedene statischen Reibmodelle lassen sich zum "Kinetischen Reibmodell" 
\begin{equation}
F_\mathrm{Kin} = \begin{cases}F_\mathrm{A} &,\Delta \omega=0 \\
 F_\mathrm{Stribeck}\; \mathrm{sign}(\Delta \omega)+F_\mathrm{V} &, \Delta \omega \neq 0\end{cases}
\end{equation}
zusammenfassen \cite{Altpeter.1999}.

Eine Schwäche dieses Modells ist der unstetige Verlauf der Reibkennlinie bei $\Delta \omega=0$. Diese Schwäche kann durch die Annäherung der Reibkennlinie über eine stetige atan-Funktion behoben werden. Dennoch bedarf es weiterhin der Unterscheidung zwischen Haft- und Gleitbereich. Hierfür ist entweder eine variable Zeitschrittweite des Solvers notwendig oder die Definition eines Geschwindigkeitbandes um $\Delta\omega=0$. Des weiteren ist die Reibkraft im Haftbereich von den äußeren Kräften abhängig, welche hier nicht bekannt sind und durch das Modell berechnet werden sollen. Aus diesen Gründen werden im Folgenden dynamische Reibmodelle betrachtet, welche diese Schwächen nicht aufweisen. 

\subsection{Dynamische Reibmodelle}
Um die dynamischen Reibeffekte vorallem um $\Delta\omega=0$ mit berücksichtigen zu können werden dynamische Reibmodelle benötigt. Einen ersten Ansatz dazu liefert das Reibmodell von Dahl. Dieses beschreibt die dynamischen Reibeffekte für kleine Auslenkungen mit kleinen Federn in den Kontaktbereichen von Körpern und geht anschließend in die Coulombschen-Reibung über \cite{Schroeder.2015}. Die Reibdynamik des Dahlschen-Modells wird definiert durch die Differentialgleichung
\begin{equation}
F_\mathrm{R,Dahl} = \left[\sigma_0\ \vert 1-\frac{F_\mathrm{R,Dahl}}{F_\mathrm{C}}\mathrm{sign}(\Delta\omega)\vert^\beta\ \mathrm{sign}\left( 1-\frac{F_\mathrm{R,Dahl}}{F_\mathrm{C}}\mathrm{sign}(\Delta\omega)\right)\right]\Delta\omega
\end{equation}
mit der zuvor definierten Coulomschen-Reibkraft $F_\mathrm{C}$, der Federsteifigkeit $\sigma_0$ und dem Formparameter der Hysterese $\beta$. Das Lund-Grenoble (LuGre) Reibmodell erweitert das Modell von Dahl um einen Dämpfungsanteil und ersetzt die Coulombsche-Kraft durch einen beliebige Reibkraftkennlinie $F_\mathrm{SS}$. Die Kontaktstellen der Reibflächen werden dabei als "Borsten"  modelliert, welche die Borstensteifigkeit $\sigma_0$ und die Borstendämpfung $\sigma_1$ besitzen. Mit der Borstenauslenkung $z$ lässt sich die LuGre-Reibkraft angeben als
\begin{equation}
F_\mathrm{R,LuGre} = \sigma_0\, z + \sigma_1 \dot{z} + \sigma_2\, \Delta \omega\quad \mathrm{mit}\  \dot{z}=\Delta\omega\left(1-\frac{\sigma_0 z}{F_\mathrm{SS}}\right)
\end{equation} 
wobei $\sigma_2$ der Steigungskoeffizienten der viskosen Reibung ist und $z_\mathrm{SS} = F_\mathrm{SS}/\sigma_0$ die maximale Borstenauslenkung[Quelle aus Mahl ???]. Jedoch wird in \cite{Dupont.2002} gezeigt, dass dieses Modell kein elasto-plastisches Presliding abbilden kann. Daher führt jede nichtkonstante Reibkraft zu einem sogenannten plastischen Presliding von $z$ wodurch es besonders bei periodischen Kräften zu einem physikalisch nicht existierenden Drift kommt. Das Elasto-Plastische Modell erweitert das LuGre-Modell um einen elastischen Bereich für kleine $z$. Nach \cite{Dupont.2000} ergibt sich die Dynamik der Auslenkung zu 
\begin{equation}
\dot{z} = \Delta \omega \left(1-\alpha(z,\Delta \omega)\frac{\sigma_0\,z}{F_\mathrm{SS}}\right)^i,\quad i\in \mathbb{Z}
\end{equation}
wobei $i=1$ gesetzt wird und die Funktion $\alpha(z)\in\left[0,1\right]$ ein elastische Bereich für kleine $z$ erzeugt. 

Aufgrund der erläuterten Vorteile wird das Elasto-Plastische-Modell für das Simulationsmodell verwendet. Dabei wird der viskose Reibungsanteil vernachlässigt ($\sigma_2 = 0$). Mit dem mittleren Radius $r_\mathrm{m}$ der Kupplungs- und Bremsscheiben und der Anzahl der Scheiben pro Schaltelement $N_\mathrm{disc}$  lassen sich die oben beschrieben Kräfte in Momente umrechnen. Letztendlich ergibt sich das an der Welle angreifende Reibmoment des Schaltelements $k$ zu
\begin{align}\label{eq:T_Cl}
T_{\mathrm{Cl},k} = \sigma_0\,z + \sigma_1\,\dot{z}
\end{align}
mit
\begin{align}
\dot{z} &= \Delta \omega \left(1-\alpha\frac{\sigma_0\,z}{T_\mathrm{Cl,ss}}\right)\\
T_\mathrm{Cl,SS} &= k_\mathrm{sign}(\Delta \omega,z)\,2\,N_{\mathrm{Disc},k}\,r_{\mathrm{m},k}\,\mu(p_\mathrm{N},T_\mathrm{Oil},\Delta \omega)F_\mathrm{N}.\label{eq:T_ClSS}
\end{align}
Der Reibwert $\mu(p_\mathrm{N},T_\mathrm{Oil},\Delta \omega)$ wird aus einem Kennfeld in Abhängigkeit der des Drucks an den Scheiben $p_\mathrm{N}$, der Öltemperatur $T_\mathrm{Oil}$ und $\Delta \omega$ gewonnen. Die Größe $k_\mathrm{sign}(\Delta \omega,z)$ definiert das Vorzeichen der Reibkraft. Zur Optimierung des numerischen Verhaltens des Simulationsmodells bei geschlossener Kupplung d.h. $\Delta \omega = 0$ wird dieser definiert zu 
\begin{equation}
k_\mathrm{sign}(\Delta \omega,z)=\begin{cases} \mathrm{sign}(z)\quad &,z\neq 0\\\mathrm{sign}(\Delta \omega)\quad &,z = 0\end{cases}.
\end{equation}
Die Normalkraft $F_\mathrm{N}$ ergibt sich aus $p_\mathrm{N}$ und der Fläche der Scheiben $A_\mathrm{Disc}$ und wird im Simulationsmodell vorgegeben. 

Mit $z_\mathrm{SS} = T_\mathrm{Cl,SS}/\sigma_0$ und $\lim_{z \rightarrow z_\mathrm{SS}}\alpha(z)=1$ konvergiert \eqref{eq:T_Cl} im Gleitbereich ($\Delta \omega \neq 0$) gegen $T_\mathrm{Cl,SS}$. 

\section{Beschreibung eines Gangwechsels}\label{sec:Gangwechsel}
Bei einem Gangwechsel wird durch die Betätigung von Schaltelementen die Übersetzung des Getriebes geändert. Dies soll zum einen in jedem Fall möglichst ohne für den Fahrer spürbare unerwünschte Beschleunigungen am Getriebeabtrieb passieren. Zum anderen soll der Gangwechsel aber auch so schnell wie möglich und ohne Momentenunterbrechung vollzogen werden. Es besteht also eine Zielkonflikt zwischen den Komfortansprüchen des Fahrers und der Dauer eines Schaltvorgangs. 

Grundsätzlich wird ein Gangwechsel auf zwei Ebenen unterschieden. Zum einen die Richtung der Übersetzung $i_\mathrm{Gang}$. Bei einer Hochschaltung wird $i_\mathrm{Gang}$ kleiner und entsprechend bei einer Rückschaltung größer. Zum anderen die Richtung des Antriebsmoments am Getriebeeingang. Ist dieses positiv spricht man von einer Zugschaltung bei negativem Antriebsmoment von einer Schubschaltung \cite{Fischer.2016}.
In dieser Arbeit werden die Betrachtungen auf eine Zug-Hoch-Schaltung zwischen dem zweitem und dem dritten Gang reduziert. Dies hat zum einen den Grund, dass in diesen Gängen der Drehmomentenwandler überbrückt und die Trennkupplung geschlossen ist, sodass deren Dynamik vernachlässigt werden kann. Zum anderen ist dies eine häufige Schaltung im Fahrzeugbetrieb. Die Erkenntnisse können jedoch auch auf andere Gangwechsel übertragen werden.

Bei dem in dieser Arbeit betrachteten Getriebe wird ein Gangwechsel mittels der Schließung und der simultanen Öffnung einer Bremse bzw. Kupplung realisiert. Bei der Schaltung zwischen dem zweiten und dritten Gang sind dies die Bremse $B_\mathrm{05}$ und die Kupplung $K_\mathrm{38}$. Der Gangwechsel wird in die vier Phasen 2. Gang, Momentenübergabe, Drehzahlsynchronisation und 3. Gang eingeteilt. Die Abbildungen \ref{fig:Gang23_Geschw}-\ref{fig:Gang23_Tandw} zeigen die vier Phasen des Gangwechsels der zur Auswertung der Sensitivitäten im Folgenden verwendet wird.

Im 2. Gang ist die Kupplung $K_\mathrm{38}$ geschlossen und überträgt das volle Antriebsmoment. Die Differenzdrehzahl $\Delta \omega_{38}$ der Wellen 3 und 8 ist somit gleich Null. Die Bremse $B_\mathrm{05}$ ist geöffnet und überträgt kein Drehmoment. Vor dem Gangwechsel wird die Kupplung $K_\mathrm{38}$ durch eine Reduzierung des anliegenden Drucks ins Schleifen gebracht, sodass sich an der Kupplung eine minimale Drehzahldifferenz ergibt. Dadurch wirkt an den Scheiben der Kupplung die Gleitreibung, welche somit der Reaktionskraft an den Kupplungen entspricht. Der Betrag der Geleitreibung kann, wie in \ref{sec:mod_reib} beschrieben, mit dem Reibungskoeffizient und der Normalkraft berechnet werden.

Somit kann während der Momentenübergabe das Drehmoment an $K_\mathrm{38}$ abgesenkt werden, während gleichzeitig $B_\mathrm{05}$ mit Hilfe einer Vorsteuerung derart geschlossenen wird, dass stets das volle Antriebsmoment übertragen wird und $K_\mathrm{38}$ im Schleifen gehalten wird. Die Herleitung einer derartigen Vorsteuerung kann \cite{Weber.2018} entnommen werden.    
  
Wenn $K_\mathrm{38}$ vollständig geöffnet ist d.h. kein Drehmoment mehr übertragen wird beginnt die Drehzahlsynchronisation. Diese kann auf zwei Arten vollzogen werden. Zum einen kann das Drehmoment an $B_\mathrm{05}$ überhöht werden, wodurch die Differenzdrehzahl $\Delta \omega_{05}$ auf Null gebracht wird und die Antriebsdrehzahl abgesenkt wird. Eine weitere Möglichkeit, die sich besonders bei Hybridgetrieben anbietet, ist die Drehzahlsynchronisation mittels einer Absenkung des Antriebsmomentes herzustellen. Mit einer E-Maschine kann die Absetzung dabei schneller und genauer vollzogen werden, als mit einem Verbrennungsmotor. Bei dem in dieser Arbeit betrachteten Gangwechsel werden beide Möglichkeiten gleichzeitig genutzt.

Am Ende der Drehzahlsynchronisation ist $\Delta \omega_{05}=0$ und die Getriebeübersetzung $i_\textrm{Gang}$ in \ref{fig:Gang23_Geschw} liegt auf dem Niveau des dritten Gangs.

\begin{figure}[h]
\centering
\newlength\fheight 
\setlength\fheight{8cm}
\newlength\fwidth 
\setlength\fwidth{13cm}
\input{figures/03_Sensitivitaetsanalyse/01_Gangwechsel/Gang23_Geschw.tex}
\caption{Zeitlicher Verlauf der Drehzahlen und Verdrehung der Seitenwellen beim Gangwechsel}
\label{fig:Gang23_Geschw}
\end{figure}

\begin{figure}[h]
\centering
\newlength\aheight 
\setlength\aheight{8cm}
\newlength\awidth 
\setlength\awidth{13cm}
\input{figures/03_Sensitivitaetsanalyse/01_Gangwechsel/Gang23_Besch.tex}
\caption{Zeitlicher Verlauf der Beschleunigungen und Verdrehungsgeschwindigkeit der Seitenwellen  beim Gangwechsel}
\label{fig:Gang23_Besch}
\end{figure}

\begin{figure}[h]
\centering
\newlength\bheight 
\setlength\bheight{16cm}
\newlength\bwidth 
\setlength\bwidth{13cm}
\input{figures/03_Sensitivitaetsanalyse/01_Gangwechsel/Gang23_Tandw.tex}
\caption{Zeitlicher Verlauf der übertragenen Drehmomenten und der Differenzgeschwindigkeiten an $K_{38}$ und $B_{05}$, des Eingangsmoments $T_{\textrm{In}}$ und des Widerstandsmoments $T_{\textrm{res}}$ beim Gangswechsel.}
\label{fig:Gang23_Tandw}
\end{figure}

\newpage